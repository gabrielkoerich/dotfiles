rules:
  - id: shell-rm-rf-root
    languages: [bash]
    severity: ERROR
    message: "Potentially destructive root deletion pattern."
    pattern-regex: '\brm\s+-rf\s+/\b'
    paths:
      exclude:
        - bin/macos
        - bin/priv

  - id: shell-chmod-777
    languages: [bash]
    severity: WARNING
    message: "Avoid world-writable permissions (chmod 777)."
    pattern-regex: '\bchmod\s+777\b'

  - id: shell-mktemp-u
    languages: [bash]
    severity: ERROR
    message: "mktemp -u is insecure (TOCTOU risk)."
    pattern-regex: '\bmktemp\s+-u\b'

  - id: shell-eval-use
    languages: [bash]
    severity: WARNING
    message: "eval is high risk; avoid unless strictly necessary and sanitized."
    pattern-regex: '\beval\b'
    paths:
      exclude:
        - bin/security-audit
        - home/.tmux/renew.sh
        - home/.tmux/yank.sh
